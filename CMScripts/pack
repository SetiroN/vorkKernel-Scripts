#!/bin/bash

if [ -f $HOME/vorkKernel-Scripts/CMScripts/Tools/ccache.txt ]; then	
	export ARM_EABI="ccache $HOME/vorkChain/toolchain/bin/arm-eabi-"
	export USE_CCACHE=1
else 
	export ARM_EABI=/home/$USER/vorkChain/toolchain/bin/arm-eabi-
fi
export BUILD_DIR=$HOME/Dropbox/Public
export SCRIPT_DIR=$HOME/vorkKernel-Scripts
export SOURCE_DIR=$HOME/CMKernelLG/lge-kernel-star

rm $SCRIPT_DIR/CMScripts/Tools/ramdisk-boot
rm $SCRIPT_DIR/CMScripts/Tools/newBoot.img
DIR=$PWD
echo "Do you want to build a release or a test version?"
echo "1 for Release, 2 for Test"
read BUILD
case $BUILD in
	1) export release=release 
	;;
	2) export release=test 
	;;
esac 
clear
. Scripts/kernelcompile.sh
cp $SOURCE_DIR/arch/arm/boot/zImage $SCRIPT_DIR/CMScripts/Awesome.zip/tmp/vorkKernel/zImage
cd $SOURCE_DIR
git revert -n 9e7ff480926d1c81ae10
cd $SCRIPT_DIR/CMScripts
. Scripts/kernelcompile.sh
cp $SOURCE_DIR/arch/arm/boot/zImage $SCRIPT_DIR/CMScripts/Awesome.zip/tmp/vorkKernel/1080p/zImage
clear
. Scripts/kernelpack.sh
if [ "$release" == "release" ]; then
python Scripts/pyndexer/pyndexer.py

cd $SOURCE_DIR
git cherry-pick -n 9e7ff480926d1c81ae10
cd $SCRIPT_DIR/CMScripts
fi

